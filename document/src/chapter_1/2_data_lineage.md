## 1.2 Понятие линии данных. Основные задачи и принципы построения линии данных в системах управления данными.

Data-driven подход к управлению требует проработанной 
аналитики над данными, которые протекают в организации. При работе 
с большими данными всегда стоит задача систематизации знаний о
протекающих потоках данных в ИТ-инфраструктуре. При работе с аналитическим 
хранилищем данных требуется понимание того, откуда будет происходить загрузка данных,
в каких объёмах, насколько регулярно, будут ли проводиться при этом какие-либо
промежуточные трансформации и пр. Эти знания необходимы для понимания
специфики данных и потенциальных проблем, из-за которых могут произойти
потери в качестве данных.

Для формирования целостной картины об объектах данных в хранилище, источниках
его обогащения, принципах вычисления, используются линии данных (Data Lineage).
Эта абстракция моделирует связи между объектами данных из разных систем, определяя, какие 
из них используются для формирования других на необходимом уровне детализации. Через линии
данных аналитик может понять, как используется тот или иной объект, какие операции в хранилище 
при этом выполняются (@fig:data-lineage).

<!-- ! Рисунок линии формирования данных  -->
![Пример линии данных в программе ataccama](static/data-lineage.jpeg){#fig:data-lineage}

Линия данных решает следующие задачи:

- учёт всех объектов (внутренних и внешних) хранилища для формирования сведений о них;

- формирование представления о принципах построения объектов;

- обеспечение консистентности хранимой информации в DWH;

- помощь в поиске уязвимых объектов с точки зрения зависимости от их использования.
  

В классическом представлении линия данных представляет собой ацикличный направленный граф
(Directed acyclic graph – DAG), в котором начальными узлами являются таблицы-источники,
а конечным узлом является целевая таблица-отчёт, формируемая в результате выполнения
большого числа трансформаций с данными. Промежуточные узлы в графе определяют
производимые в потоке данных трансформации, такие как соединение таблиц, их объединение, 
фильтрация и многие другие, при этом каждая из перечисленных трансформаций формирует
собственный узел в графе.

Направленные связи между узлами в графе определяют взаимосвязанные между собой трансформации.
Эту связь можно описать как "... формируется при помощи ... - ... используется для ...", то есть тот 
узел, из которого выходит стрелка, используется для выполнения трансформации, в
которую стрелка эта входит. При этом, если одна и та же таблица используется 
несколько раз в трансформации, каждое использование узла требует создание собственной
стрелки. В большинстве случаев, когда несколько узлов используется для трансформации, 
говорят о соединении таблиц или их объединении. Для более высокой детализации линия данных
может описывать не только переходные трансформации, но и используемые при этих
трансформациях поля и вычисляемые значения (@fig:data-lineage-fields).

<!-- ! Рисунок линии формирования данных с полями -->
![Линия данных с примером определения полей заполнения в SQLFlow](static/field-data-lineage.png){#fig:data-lineage-fields}

В линии данных также стоит учитывать происхождение таблиц-источников,
из которых происходит выгрузка данных. Это необходимо для тех потоков 
формирования данных, в которых трансформация данных происходит на основе
данных из нескольких систем сразу. В таком случае разработчик сможет определить
точки взаимодействия между системами и возможные узкие места на этапах трансфера данных
из системы в систему.

На данный момент существует большое количество программных инструментов,
которые позволяют выстраивать линии данных. Каждый из них ориентирован на свой
перечень поддерживаемых систем управления базами данных, следовательно, 
использует свои подходы для формирования модели линии данных.
К основным используемым методам относятся следующие: анализ мета-информации
сообщений передачи данных, использование статического анализа исходного
кода, анализ формируемых мета-данных на стороне пользователя при помощи
разработанного API. Каждый из перечисленных методов имеет свои 
преимущества с точки зрения автоматизации наполнения, однако 
у каждого метода есть недостатки с точки зрения интерпретации входной информации для системы, что не позволяет 
сделать один из методов целевым и универсальным.

Data Lineage в синтезе с аналитическим хранилищем данных формирует
целостную систему управления данными, которая позволяет проводить 
надежную аналитику на основе известных поставщиков данных. Понимание
природы данных (то, как они формируются и попадают в хранилище) даёт аналитику 
дополнительное представление о том, как эти данные влияют на
итоговый результат и рассчитываемые аналитические показатели.