# 2.3 Обзор числовых показателей, применяемых с использованием статического анализа SQL-запросов

Статический анализ предполагает, что полученная абстрактная модель представления исходного кода 
будет в дальнейшем использоваться для аналитики. Для проведения сравнительного анализа 
используются числовые показатели (метрики), которые позволяют объективно сопоставить
между собой различные программные решения с точки зрения их качества по выбранным критериям.
При оценке качества работы с большими данными также прибегают к оценке качества
выполняемых преобразований над данными, при этом данные могут использоваться в дальнейшем 
для разных задач: формирование корпоративной отчётности, обогащение данных информацией
из нескольких систем-источников, подготовка данных для машинного обучения и т.д. Данная
оценка может проводиться как для уже выполненных операций, так и для запросов без их
выполнения, только на основе иходного кода SQL-запроса.

Базовые числовые показатели, которые могут быть сформированы с помощью статического анализа,
предполагают оценку структуры спроектированной базы данных. В качестве источника данных
для проведения оценки качества структуры данных служит SQL-запрос определения
структуры данных, Data Definition Language. Метрики качества структуры данных можно разделить
на следующие уровни: уровень атрибутов, уровень таблиц, уровень базы данных.

На уровне атрибутов для оценки качества используются метрики оценки объёма памяти,
потребляемые для данной колонки. Для простых типов данных предполагается, что
занимаемый объём памяти соответствует фиксированному значению в соответствии
с выбранным типом данных, поскольку они имеют определённую разрядность 
хранимых значений. Для составных типов вес атрибута будет складываться из веса
простых типов данных, из которых состоят его атрибуты или значения. 

Поскольку таблицы состоят из атрибутов, то метрики на уровне таблиц формируются
в соответствии с её атрибутным составом. Объём таблицы состоит из объёма памяти,
занимаемого всеми атрибутами таблицы. Однако у таблиц есть и собственные метрики,
которые вытекают из связей с другими таблицами в схеме. Также на основе данных
об атрибутах таблицы можно рассчитать такие метрики, как доля простых и составных
атрибутов относительно всех атрибутов таблицы. Также, для каждой таблицы можно
рассчитать глубину реляционного дерева. Глубина реляционного дерева определяется
как самая длинная цепочка связей между таблицами, начиная с данной таблицы, при
это для рекурсивных деревьев связь считается только один раз.

Показатели на уровне схемы базы данных формируются из метрик таблиц и атрибутов,
следовательно, они являются суммарными показателями по всей базе данных: 
объём схемы как сумма объёмов всех таблиц, количество таблиц, количество атрибутов,
глубина реляционного дерева как максимальная глубина реляционного дерева среди всех таблиц.

В РСУБД помимо таблиц существуют и другие объекты, такие как представления, 
индексы, хранимые процедуры, для которых также можно рассчитывать числовые показатели.
Хранимые процедуры являются объектами, которые могут влиять на структуру данных,
состояние данных и их качество, поэтому они являются хорошим объектов для анализа.

Длина хранимой процедуры как показатель определяется числом операций, выполняемых
внутри неё. К операциям относятся все SELECT, UPDATE, CREATE, DELETE, INSERT, DROP,
DECLARE и IF выражения внутри процедуры. В зависимости от используемой СУБД этот
перечень операций может расширяться из-за возможностей языка. Цель этого показателя - 
выявить чрезмерно большие процедуры. Любая процедура, длина которой больше 1, скорее всего,
требует упрощения, но в любом проекте всегда будет стоять задача сначала оптимизировать
процедуры наибольшей длины. Транзакционная и аналитическая ориентированность процедуры – 
показатели, которые описывают хранимую процедуру с точки зрения принадлежности её к 
OLTP или OLAP направленности действий. Транзакционная ориентированность хранимой процедуры
определяется как отношение числа операций UPDATE, CREATE, DELETE, INSERT к длине процедуры,
а аналитическая ориантированность – как отношение числа операций SELECT к длине процедуры.

<!-- TODO: Придумать вывод к этому всему -->