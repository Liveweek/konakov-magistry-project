# 2.2 Обзор абстрактных моделей, формируемых в результате статического анализа

Статический анализ служит инструментом преобразования исходного кода программы в абстрактные модели,
которые уже можно использовать как для дальнейшего преобразования в другие форматы представления
данных (схемы, графики, диаграммы, конфигурации и др.), так и для сбора статистики и 
выполнения других аналитических задач. При этом модели могут как представлять 
собой абсолютно произвольную структуру, так и быть стандартным представлением 
какой-либо сущности. Самым наглядным примером в данном
случае может быть формирование диаграммы классов на основе исходного кода программы, где 
представлено определение классов, их методов, атрибутов и связей между ними.

Диаграмма классов UML является классической нотацией для описания статического
состояния программного проекта. Она содержит полноценное описание классов и интерфейсов,
их состав в виде атрибутов и методов, их уровень доступа, а также связи между классами,
их кратность и сила (@fig:cl-diag-example). 

<!-- ! Рисунок примера диаграммы классов -->
![Пример диаграммы классов](static/class-diagram-example.png){#fig:cl-diag-example}

Диаграмма классов в статическом анализе позволяет проводить 
преобразование исходного кода 1 к 1, то есть, если в дальнейшем потребуется выполнить
генерацию программного кода на основе диаграммы классов, то это будет возможно и структура
программы будет идентична исходной. Реализацию методов на уровне кода, конечно, воспроизвести
не получится, поскольку поведение классов и их работу описывают диаграммы динамического
описания системы (диаграммы последовательности, диаграммы состояний и др.). Однако уже в
таком представлении можно проводить анализ кода для определения зависимостей между
модулями проекта, что может быть полезно при рефакторинге или оптимизации проекта, а в совокупности
с данными о наборе тестов это позволяет проводить анализ покрытия программных компонентов тестами.

Для работы с реляционными базами данных и языком SQL также существует стандартная нотация
"Сущность-Связь" (ER-диаграмма), которая позволяет описывать структуру базы данных в виде
сущностей, их атрибутов и связей между ними (@fig:er-diag-example). 

<!-- ! Рисунок примера диаграммы "Сущность-Связь" -->
![Пример диаграммы "Сущность-связь"](static/entity-relationship-example.png){#fig:er-diag-example}

Поскольку связи в реляционных системах управления базами данных (РСУБД) не только логические,
а также имеют физическую реализацию (наложение ограничений на поле таблицы, ограничивая 
значения лишь набором первичных ключей связанной сущности), при помощи ER-диаграммы можно определять
число сущностей, с которыми она связана, что будет играть в случае удаления данных или
изменения структуры связанных таблиц. С точки зрения статического анализа ER-диаграмма
также представляется при помощи транзитивных преобразований исходного кода SQL-запросов
по созданию таблиц (Data Definition Language, DDL). Запросы создания таблиц содержат в себе
информацию о наименовании таблицы, ее полей, типах данных, ограничениях и связях с другими
таблицами, что позволяет построить ER-диаграмму на основе этих данных. При помощи
статического анализа SQL-запросов через ER-диаграмму можно определять возможные ошибки в
структуре создаваемых объектов, например, отсутствие ограничений на внешние ключи, что
может привести к некорректному заполнению данных в таблицах и навредить консистентности
хранимой информации в системе.

Ещё одним примером абстрактной модели, формируемой в результате статического анализа, является
поток управления программы (Control Flow Graph, CFG). CFG представляет собой граф операций, которые
выполняются в программе в соответствии с вариантами ветвления программы на основе выполнения
условий в условных операторах. В гарфе потока управления каждый узел представляет собой прямолинейный
фрагмент кода, а ребра - переходы между фрагментами. Потока управления программы имеет две
специальные вершины – начальную и конечную. Начальная вершина является точкой входа в программу, а
конечная, соответственно, является точкой, через которую выходит весь поток управления (@fig:cfg-diagram-example).

<!-- ! Рисунок графа потока управления программой -->
![Пример графа потока управления программой](static/cfg-example.png){#fig:cfg-diagram-example}

Анализ потока управления позволяет определить возможные пути выполнения программы, 
а также определить фрагменты кода, в которых происходит вычисление или использование определённых
переменных. Это может позволить выявить места в коде, где происходит изменение значений переменных,
и обнаружить уязвимости или возможные места оптимизации кода. 

Таким образом, представленные примеры абстрактных моделей представления, сформированные
с помощью статического анализа, позволяют решать большой спектр задач по 
аналитике программного кода: анализ структуры модели, анализ взаимосвязей моделей 
между собой, анализ последовательности изменений объекта и др. Все эти задачи 
тем или иным образом могут также решаться при анализе линии формирования данных.